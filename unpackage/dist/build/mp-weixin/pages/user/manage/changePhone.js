(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/manage/changePhone"],{1150:function(n,e,t){"use strict";(function(n){t("ecea");i(t("66fd"));var e=i(t("d51a"));function i(n){return n&&n.__esModule?n:{default:n}}wx.__webpack_require_UNI_MP_PLUGIN__=t,n(e.default)}).call(this,t("543d")["createPage"])},"25da":function(n,e,t){},"2af5":function(n,e,t){"use strict";t.d(e,"b",(function(){return o})),t.d(e,"c",(function(){return u})),t.d(e,"a",(function(){return i}));var i={uniSection:function(){return t.e("components/uni-section/uni-section").then(t.bind(null,"d61b"))},uniForms:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(t.bind(null,"7fed"))},uniFormsItem:function(){return t.e("uni_modules/uni-forms/components/uni-forms-item/uni-forms-item").then(t.bind(null,"c251"))},"u-Input":function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u--input/u--input")]).then(t.bind(null,"572f"))},uniEasyinput:function(){return t.e("uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput").then(t.bind(null,"662b"))}},o=function(){var n=this,e=n.$createElement;n._self._c},u=[]},ba77:function(n,e,t){"use strict";(function(n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=u(t("a34a")),o=t("e997");function u(n){return n&&n.__esModule?n:{default:n}}function a(n,e,t,i,o,u,a){try{var r=n[u](a),s=r.value}catch(c){return void t(c)}r.done?e(s):Promise.resolve(s).then(i,o)}function r(n){return function(){var e=this,t=arguments;return new Promise((function(i,o){var u=n.apply(e,t);function r(n){a(u,i,o,r,s,"next",n)}function s(n){a(u,i,o,r,s,"throw",n)}r(void 0)}))}}var s={components:{},data:function(){return{valiFormData:{name:"",age:"",cardNumber:"",phone:"",code:""},time:"",text:"获取验证码",disabled:!1,isCanClick:!1,patientId:"",rules:{phone:{rules:[{required:!0,errorMessage:"手机号不能为空"},{validateFunction:function(n,e,t,i){var o=/^1[34578]\d{9}$/;return!1===o.test(e)&&e&&i("请输入正确格式的手机号码"),!0}}]},code:{rules:[{required:!0,errorMessage:"验证码不能为空"}]}}}},computed:{},methods:{listeningFocus:function(){this.getCardTypeNumber(this.valiFormData.phone)},getCardTypeNumber:function(e){var t=/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-7|9])|(?:5[0-3|5-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[1|8|9]))\d{8}$/;if(!1===t.test(e)&&e){var i="请输入正确格式的手机号码";this.isCanClick=!1,n.showToast({icon:"none",title:i,duration:2e3,position:"top"})}else e&&(this.isCanClick=!0)},onSubmit:function(n){var e=this;this.$refs[n].validate().then((function(n){e.editPhone()})).catch((function(n){console.log("err",n)}))},getSmsCode:function(){if(this.listeningFocus(1),this.isCanClick){if(this.disabled)return;this.disabled=!0,this.sendSmsCode(),this.setInterValFunc()}else n.showToast({icon:"none",title:"请输入正确格式的手机号码",duration:2e3,position:"top"})},sendSmsCode:function(){var n=this;return r(i.default.mark((function e(){var t,u,a;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n,u={mobile:t.valiFormData.phone},e.next=4,(0,o.sendSms)(u);case 4:a=e.sent,a.code&&n.$tools.message("发送成功","suc");case 6:case"end":return e.stop()}}),e)})))()},setInterValFunc:function(){var n=this;this.time=60,this.text="秒",this.setTime=setInterval((function(){n.time-1==0?(n.time="",n.text="重新获取",n.code="",n.disabled=!1,clearInterval(n.setTime)):n.time--}),1e3)},smsCode:function(n){var e=this;n=n.match(/^\d{0,6}/g)[0]||"",this.$nextTick((function(){e.valiFormData.code=n}))},editPhone:function(){var n=this;this.$tools.showModal("","确认更改号码?").then((function(e){e&&n.editPatientMobile()}))},editPatientMobile:function(){var n=this;return r(i.default.mark((function e(){var t,u,a;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n,u={mobile:t.valiFormData.phone,smsCode:t.valiFormData.code},e.next=4,(0,o.editPatientMobile)(u,n.patientId);case 4:a=e.sent,1e5==a.code&&(n.$tools.message("修改成功","suc"),n.back());case 6:case"end":return e.stop()}}),e)})))()},back:function(){n.navigateTo({url:"bankcard"})}},props:{tabCur:{type:Number,default:0}},onLoad:function(n){this.patientId=n.patientId}};e.default=s}).call(this,t("543d")["default"])},d51a:function(n,e,t){"use strict";t.r(e);var i=t("2af5"),o=t("f76a");for(var u in o)"default"!==u&&function(n){t.d(e,n,(function(){return o[n]}))}(u);t("edf7");var a,r=t("f0c5"),s=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=s.exports},edf7:function(n,e,t){"use strict";var i=t("25da"),o=t.n(i);o.a},f76a:function(n,e,t){"use strict";t.r(e);var i=t("ba77"),o=t.n(i);for(var u in i)"default"!==u&&function(n){t.d(e,n,(function(){return i[n]}))}(u);e["default"]=o.a}},[["1150","common/runtime","common/vendor"]]]);